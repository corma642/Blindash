#pragma once

#include "Actor/Actor.h"
#include "Utils/Timer.h"

class Player : public Actor
{
	RTTI_DECLARATIONS(Player, Actor)

public:
	Player(const Vector2& position);

	virtual void BeginPlay() override;
	virtual void Tick(float deltaTime) override;

	// 플레이어 슈퍼 모드 Getter/Setter
	FORCEINLINE void StartSuperMode() { bStartSuperMode = true; }
	FORCEINLINE bool GetEnableSuperMode() const { return bEnableSuperMode; }
	FORCEINLINE void SetEnableSuperMode(bool inSuperMode) { bEnableSuperMode = inSuperMode; }

public:
	// 플레이어의 시야 반경을 영구적으로 약간 증가시키는 함수
	void ItemExpandVisionRange();

	// n초간 암흑이 모두 걷히고, 플레이어가 무적이 되며, 몬스터또한 처치 가능한 함수
	void ItemActivateSuperMode(float deltaTime);

private:
	// 이동 입력 처리 함수
	void PlayerMovement(float deltaTime);

	/*
	* 수평 이동 (X축) 함수
	* sign:	true = 오른쪽(+), false = 왼쪽(-)
	* isRepeat: 연속 이동 여부
	*/
	void HorizontalMove(bool sign, bool isRepeat);

	/*
	* 수직 이동 (Y축) 함수
	* sign:	true = 아래쪽(+), false = 위쪽(-)
	* isRepeat: 연속 이동 여부
	*/
	void VerticalMove(bool sign, bool isRepeat);

private:
	// 반복/연속 이동 타이머 (X축과 Y축 별도)
	Timer playerRepeatMoveXTimer;
	Timer playerRepeatMoveYTimer;

	// 반복/연속 이동 임계값 (지연 시간)
	float xMoveThreshold = 0.1f;
	float yMoveThreshold = 0.2f;

	// 게임 레벨 인터페이스
	class IGameLevelInterface* gameLevelInterface = nullptr;

	// 플레이어 슈퍼 모드 상태 변수
	Timer SuperModeTimer;
	bool bStartSuperMode = false;
	bool bEnableSuperMode = false;
	float SuperModeTime = 3.0f;
};
